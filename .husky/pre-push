#!/usr/bin/env bash

RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

echo -e "${YELLOW}üèóÔ∏è Final Build Safety Check...${NC}"

# Run the full build
if npm run build; then
  echo -e "${GREEN}üöÄ Build successful! Pushing to remote...${NC}"
else
  echo ""
  echo -e "${RED}üõë PUSH REJECTED: Build Failed!${NC}"
  echo "----------------------------------------------------------------"
  echo "Your code would break the production build."
  echo -e "${YELLOW}Common causes:${NC}"
  echo "  1. Missing environment variables (.env.local not present on CI)"
  echo "  2. Broken dynamic routes or API paths"
  echo "  3. Circular dependencies in your components"
  echo ""
  echo -e "Run ${GREEN}npm run build${NC} locally to see the full error log."
  echo "----------------------------------------------------------------"
  exit 1
fi